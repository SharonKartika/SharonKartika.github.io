<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/styles/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="/assets/favicon.png"> <title>Numerical Integration</title> <header> <div class=blog-name ><a href="/">Sharon Kartika</a></div> <nav> <ul> <li><a href="/">Home</a> <li><a href="/projects/">Projects</a> <li><a href="/notes/">Notes</a> </ul> <img src="/assets/hamburger.svg" id=menu-icon > </nav> </header> <div class=franklin-content ><h1 id=numerical_integration ><a href="#numerical_integration" class=header-anchor >Numerical Integration</a></h1> <p>Some functions cannot be integrated analytically. Numerical integration applies the definition of a definite integral, which is the area under the curve, to calculate the integral approximately. </p> <h2 id=riemann_sum ><a href="#riemann_sum" class=header-anchor >Riemann sum </a></h2> <p>Divide the interval into <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> equally spaced intervals, and sum up the areas under the rectangles formed by them. </p> <pre><code class="python hljs"><span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np

f = <span class=hljs-keyword >lambda</span> x: x**<span class=hljs-number >3</span> 
analytic_integral = <span class=hljs-number >1</span>/<span class=hljs-number >4</span>

<span class=hljs-keyword >def</span> <span class="hljs-title function_">IntegrateRiemann</span>(<span class=hljs-params >f, a=<span class=hljs-number >0.</span>, b=<span class=hljs-number >1.</span>, N=<span class=hljs-number >10</span></span>):
    X, h = np.linspace(a, b, N+<span class=hljs-number >1</span>, retstep = <span class=hljs-literal >True</span>)
    <span class=hljs-keyword >return</span> h * <span class=hljs-built_in >sum</span>(f(X[<span class=hljs-number >1</span>:-<span class=hljs-number >1</span>]))

numeric_integral = IntegrateRiemann(f, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >10</span>)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;Numeric integral: %6f \nAnalytic integral: %6f \nDifference: %6f&quot;</span> \
     % (numeric_integral, analytic_integral, <span class=hljs-built_in >abs</span>(numeric_integral-analytic_integral)))</code></pre> <pre><code class="julia hljs">Numeric integral: <span class=hljs-number >0.202500</span> 
Analytic integral: <span class=hljs-number >0.250000</span> 
Difference: <span class=hljs-number >0.047500</span></code></pre> <p>An improvement can be achieved by calculating the the function at the midpoints of the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> intervals</p> <pre><code class="python hljs"><span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np

f = <span class=hljs-keyword >lambda</span> x: x**<span class=hljs-number >3</span> 
analytic_integral = <span class=hljs-number >1</span>/<span class=hljs-number >4</span>

<span class=hljs-keyword >def</span> <span class="hljs-title function_">IntegrateRiemann_mid</span>(<span class=hljs-params >f, a=<span class=hljs-number >0.</span>, b=<span class=hljs-number >1.</span>, N=<span class=hljs-number >10</span></span>):
    X, h = np.linspace(a, b, N+<span class=hljs-number >1</span>, retstep = <span class=hljs-literal >True</span>)
    <span class=hljs-keyword >return</span> h * <span class=hljs-built_in >sum</span>(f(X[<span class=hljs-number >1</span>:-<span class=hljs-number >1</span>] + h/<span class=hljs-number >2</span>))

numeric_integral_mid = IntegrateRiemann_mid(f, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >10</span>)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;Numeric integral: %6f \nAnalytic integral: %6f \nDifference: %6f&quot;</span> \
     % (numeric_integral_mid, analytic_integral, <span class=hljs-built_in >abs</span>(numeric_integral_mid-analytic_integral)))</code></pre> <pre><code class="julia hljs">Numeric integral: <span class=hljs-number >0.248738</span> 
Analytic integral: <span class=hljs-number >0.250000</span> 
Difference: <span class=hljs-number >0.001262</span></code></pre> <h2 id=trapezoidal_rule ><a href="#trapezoidal_rule" class=header-anchor >Trapezoidal rule</a></h2> <p>Divide the interval into <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> equally spaced intervals. A trapezoidal approximation to the area in the interval <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><msub><mi>x</mi><mi>n</mi></msub><mo separator=true >,</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[x_n,x_{n+1}]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2083em;"><span></span></span></span></span></span></span><span class=mclose >]</span></span></span></span> is </p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>A</mi><mo>=</mo><mfrac><mi>h</mi><mn>2</mn></mfrac><mo>⋅</mo><mrow><mo fence=true >[</mo><mi>f</mi><mo stretchy=false >(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=false >)</mo><mo fence=true >]</mo></mrow></mrow><annotation encoding="application/x-tex"> A = \frac{h}{2} \cdot\left[f(x_n)+f(x_{n+1})\right] </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.0574em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3714em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >⋅</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2083em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span></span> <p>Summing the areas for all the intervals gives </p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>I</mi><mo>=</mo><mi>h</mi><mrow><mo fence=true >[</mo><mfrac><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mi>b</mi><mo stretchy=false >)</mo></mrow><mn>2</mn></mfrac><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mi>h</mi><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mn>2</mn><mi>h</mi><mo stretchy=false >)</mo><mo>+</mo><mo>⋯</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mo stretchy=false >(</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mi>h</mi><mo stretchy=false >)</mo><mo fence=true >]</mo></mrow></mrow><annotation encoding="application/x-tex"> I = h\left[\frac{f(a)+f(b)}{2} + f(a+h) + f(a+2h) + \cdots + f(a+(N-1)h)\right] </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord mathnormal">h</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">b</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >2</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >1</span><span class=mclose >)</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span> <pre><code class="python hljs"><span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np

f = <span class=hljs-keyword >lambda</span> x: x**<span class=hljs-number >3</span> 
analytic_integral = <span class=hljs-number >1</span>/<span class=hljs-number >4</span>

<span class=hljs-keyword >def</span> <span class="hljs-title function_">IntegrateTrapezoid</span>(<span class=hljs-params >f, a=<span class=hljs-number >0.</span>, b=<span class=hljs-number >1.</span>, N=<span class=hljs-number >10</span></span>):
    X, h = np.linspace(a, b, N+<span class=hljs-number >1</span>, retstep = <span class=hljs-literal >True</span>)
    I = <span class=hljs-number >0.5</span> * (f(X[<span class=hljs-number >0</span>]) + f(X[-<span class=hljs-number >1</span>]))
    I += <span class=hljs-built_in >sum</span>(f(X[<span class=hljs-number >1</span>:-<span class=hljs-number >1</span>])) <span class=hljs-comment ># sum of all terms excluding the first and the last</span>
    I *= h 
    <span class=hljs-keyword >return</span> I
    
numeric_integral = IntegrateTrapezoid(f, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >10</span>)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;Numeric integral: %6f \nAnalytic integral: %6f \nDifference: %6f&quot;</span> \
     % (numeric_integral, analytic_integral, <span class=hljs-built_in >abs</span>(numeric_integral-analytic_integral)))</code></pre> <pre><code class="julia hljs">Numeric integral: <span class=hljs-number >0.252500</span> 
Analytic integral: <span class=hljs-number >0.250000</span> 
Difference: <span class=hljs-number >0.002500</span></code></pre> <h2 id=simpsons_rule ><a href="#simpsons_rule" class=header-anchor >Simpson&#39;s rule</a></h2> <p>A quadratic polynomial can be uniquely specified by three points. If the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> coordinates are <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>h</mi><mo separator=true >,</mo><mn>0</mn><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex">-h, 0,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8889em;vertical-align:-0.1944em;"></span><span class=mord >−</span><span class="mord mathnormal">h</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord >0</span><span class=mpunct >,</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span>, substituting in the general equation of a quadratic <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mi>y</mi><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">(y=a_0+a_1x+a_2x^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.7333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.7333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.9641em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>&#41; and solving gives,</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.25em  columnalign="right left" columnspacing=0em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><msub><mi>a</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><msub><mi>a</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>h</mi><mo stretchy=false >)</mo><mo>−</mo><mi>f</mi><mo stretchy=false >(</mo><mo>−</mo><mi>h</mi><mo stretchy=false >)</mo></mrow><mrow><mn>2</mn><mi>h</mi></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><msub><mi>a</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>h</mi><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mo>−</mo><mi>h</mi><mo stretchy=false >)</mo><mo>−</mo><mn>2</mn><mi>f</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo></mrow><mrow><mn>2</mn><msup><mi>h</mi><mn>2</mn></msup></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{align*} a_0 &amp;= f(0) \\ a_1 &amp;= \frac{f(h)-f(-h)}{2h} \\ a_2 &amp;= \frac{f(h)+f(-h)-2f(0)}{2h^2} \end{align*} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:6.326em;vertical-align:-2.913em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:3.413em;"><span style="top:-6em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.913em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.5em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:2.913em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:3.413em;"><span style="top:-6em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)</span></span></span><span style="top:-3.913em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class="mord mathnormal">h</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord >−</span><span class="mord mathnormal">h</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.5em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class=mord ><span class="mord mathnormal">h</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord >−</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:2.913em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>The integral under this quadratic, in the interval <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mo>−</mo><mi>h</mi><mo separator=true >,</mo><mi>h</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[-h,h]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >−</span><span class="mord mathnormal">h</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class=mclose >]</span></span></span></span> is given by,</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.25em  columnalign="right left" columnspacing=0em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mi>I</mi></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi>h</mi></mrow><mi>h</mi></msubsup><mo stretchy=false >(</mo><msub><mi>a</mi><mn>0</mn></msub><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><msup><mi>x</mi><mn>2</mn></msup><mo stretchy=false >)</mo><mi>d</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mn>2</mn><msub><mi>a</mi><mn>0</mn></msub><mi>h</mi><mo>+</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><msub><mi>a</mi><mn>2</mn></msub><msup><mi>h</mi><mn>3</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>h</mi><mrow><mo fence=true >(</mo><mn>2</mn><mi>f</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo>+</mo><mfrac><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>h</mi><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mo>−</mo><mi>h</mi><mo stretchy=false >)</mo><mo>−</mo><mn>2</mn><mi>f</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo></mrow><mn>3</mn></mfrac><mo fence=true >)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mfrac><mi>h</mi><mn>3</mn></mfrac><mo stretchy=false >(</mo><mi>f</mi><mo stretchy=false >(</mo><mi>h</mi><mo stretchy=false >)</mo><mo>+</mo><mn>4</mn><mi>f</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mo>−</mo><mi>h</mi><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{align*} I &amp;= \int_{-h}^{h}(a_0+a_1x+a_2x^2)dx \\ &amp;= 2a_0h+\frac{2}{3}a_2h^3\\ &amp;= h\left(2f(0) + \frac{f(h)+f(-h)-2f(0)}{3}\right)\\ &amp;= \frac{h}{3}(f(h)+4f(0)+f(-h)) \end{align*} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:10.2342em;vertical-align:-4.8671em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:5.3671em;"><span style="top:-7.3671em;"><span class=pstrut  style="height:3.599em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span><span style="top:-4.7754em;"><span class=pstrut  style="height:3.599em;"></span><span class=mord ></span></span><span style="top:-2.3394em;"><span class=pstrut  style="height:3.599em;"></span><span class=mord ></span></span><span style="top:0.2821em;"><span class=pstrut  style="height:3.599em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:4.8671em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:5.3671em;"><span style="top:-7.3671em;"><span class=pstrut  style="height:3.599em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.599em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">h</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9703em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose >)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span style="top:-4.7754em;"><span class=pstrut  style="height:3.599em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord >2</span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">h</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >3</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">h</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span><span style="top:-2.3394em;"><span class=pstrut  style="height:3.599em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class="mord mathnormal">h</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >3</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord >−</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:0.2821em;"><span class=pstrut  style="height:3.599em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3714em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >3</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >4</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class=mord >−</span><span class="mord mathnormal">h</span><span class=mclose >))</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:4.8671em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>This applies for any general interval with three equispaced points. Summing over all such pairs of intervals in our original interval, </p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.25em  columnalign="right left" columnspacing=0em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mi>I</mi></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>≈</mo><mfrac><mi>h</mi><mn>3</mn></mfrac><mo fence=false  stretchy=true  minsize=1.2em  maxsize=1.2em >[</mo><mo stretchy=false >(</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo><mo>+</mo><mn>4</mn><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mi>h</mi><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mn>2</mn><mi>h</mi><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>+</mo><mo stretchy=false >(</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mn>2</mn><mi>h</mi><mo stretchy=false >)</mo><mo>+</mo><mn>4</mn><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mn>3</mn><mi>h</mi><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mn>4</mn><mi>h</mi><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>+</mo><mo>⋯</mo><mo fence=false  stretchy=true  minsize=1.2em  maxsize=1.2em >]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mfrac><mi>h</mi><mn>3</mn></mfrac><mo fence=false  stretchy=true  minsize=1.2em  maxsize=1.2em >[</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mi>b</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>+</mo><mn>4</mn><mo stretchy=false >(</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mi>h</mi><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mn>3</mn><mi>h</mi><mo stretchy=false >)</mo><mo>+</mo><mo>⋯</mo><mtext> </mtext><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>+</mo><mn>2</mn><mo stretchy=false >(</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mn>2</mn><mi>h</mi><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mn>4</mn><mi>h</mi><mo stretchy=false >)</mo><mo>+</mo><mo>⋯</mo><mtext> </mtext><mo stretchy=false >)</mo><mo fence=false  stretchy=true  minsize=1.2em  maxsize=1.2em >]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{align*} I &amp; \approx \frac{h}{3}\big[(f(a)+4f(a+h)+f(a+2h))\\ &amp;+ (f(a+2h)+4f(a+3h)+f(a+4h)) \\ &amp;+ \cdots\big]\\\\ &amp;= \frac{h}{3}\big[f(a)+f(b)\\ &amp;+ 4(f(a+h)+f(a+3h)+\cdots)\\&amp;+2(f(a+2h)+f(a+4h)+\cdots)\big] \end{align*} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:12.2349em;vertical-align:-5.8674em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:6.3674em;"><span style="top:-8.3674em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span><span style="top:-6.5414em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ></span></span><span style="top:-5.0314em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ></span></span><span style="top:-3.5314em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ></span></span><span style="top:-1.5em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ></span></span><span style="top:0.326em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ></span></span><span style="top:1.836em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:5.8674em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:6.3674em;"><span style="top:-8.3674em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3714em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >3</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="delimsizing size1">[</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >4</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >2</span><span class="mord mathnormal">h</span><span class=mclose >))</span></span></span><span style="top:-6.5414em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >2</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >4</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >3</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >4</span><span class="mord mathnormal">h</span><span class=mclose >))</span></span></span><span style="top:-5.0314em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="delimsizing size1">]</span></span></span></span><span style="top:-1.5em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3714em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >3</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="delimsizing size1">[</span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">b</span><span class=mclose >)</span></span></span><span style="top:0.326em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >4</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >3</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mclose >)</span></span></span><span style="top:1.836em;"><span class=pstrut  style="height:3.3714em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >2</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >2</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >4</span><span class="mord mathnormal">h</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mclose >)</span><span class=mord ><span class="delimsizing size1">]</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:5.8674em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>In general, the algorithm is specified by </p> <ol> <li><p>Sum the first and last terms.</p> <li><p>Sum four times the odd terms <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mi>f</mi><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><msub><mi>n</mi><mtext>odd</mtext></msub><mi>h</mi></mrow><annotation encoding="application/x-tex">(f(a+n_{\text {odd} }h</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.8444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">odd</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">h</span></span></span></span>&#41;. </p> <li><p>Sum two times the even terms excluding the final term, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>b</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(b)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">b</span><span class=mclose >)</span></span></span></span>. </p> <li><p>Multiply the sum of above results by <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi mathvariant=normal >/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">h/3</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class=mord >/3</span></span></span></span>.</p> </ol> <blockquote> <p>One point to note is that the number of intervals need to be even. Equivalently, the number of sample points need to odd. </p> </blockquote> <pre><code class="python hljs"><span class=hljs-keyword >import</span> numpy <span class=hljs-keyword >as</span> np

f = <span class=hljs-keyword >lambda</span> x: x**<span class=hljs-number >3</span> 
analytic_integral = <span class=hljs-number >1</span>/<span class=hljs-number >4</span>

<span class=hljs-keyword >def</span> <span class="hljs-title function_">IntegrateSimpson</span>(<span class=hljs-params >f, a=<span class=hljs-number >0.</span>, b=<span class=hljs-number >1.</span>, N=<span class=hljs-number >10</span></span>):
    <span class=hljs-keyword >if</span> N % <span class=hljs-number >2</span> != <span class=hljs-number >0</span>:
        <span class=hljs-keyword >raise</span> Exception(<span class=hljs-string >&quot;Error: even number of inputs required&quot;</span>)
    X, h = np.linspace(a, b, N+<span class=hljs-number >1</span>, retstep = <span class=hljs-literal >True</span>)
    I = (f(X[<span class=hljs-number >0</span>]) + f(X[-<span class=hljs-number >1</span>])) <span class=hljs-comment ># sum the first and last terms</span>
    I += <span class=hljs-number >4</span> * <span class=hljs-built_in >sum</span>(f(X[<span class=hljs-number >1</span>:-<span class=hljs-number >1</span>:<span class=hljs-number >2</span>])) <span class=hljs-comment ># sum the odd terms and multiply by 4</span>
    I += <span class=hljs-number >2</span> * <span class=hljs-built_in >sum</span>(f(X[<span class=hljs-number >2</span>:-<span class=hljs-number >1</span>:<span class=hljs-number >2</span>])) <span class=hljs-comment ># sum the even terms, exclude the last term, multiply by 2</span>
    I *= (h/<span class=hljs-number >3</span>) 
    <span class=hljs-keyword >return</span> I
    
numeric_integral = IntegrateSimpson(f, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >10</span>)
<span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;Numeric integral: %10.10f \nAnalytic integral: %10.10f \nDifference: %10.10f&quot;</span> \
     % (numeric_integral, analytic_integral, <span class=hljs-built_in >abs</span>(numeric_integral-analytic_integral)))</code></pre> <pre><code class="julia hljs">Numeric integral: <span class=hljs-number >0.2500000000</span> 
Analytic integral: <span class=hljs-number >0.2500000000</span> 
Difference: <span class=hljs-number >0.0000000000</span></code></pre> <div class=page-foot > Sharon Kartika. Last modified: January 04, 2024. </div> </div> <script src="/libs/highlight/highlight.min.js"></script> <script>hljs.highlightAll();hljs.configure({tabReplace: ' '});</script>